<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Channel Subscriber Counts</title>
</head>
<body>
  <h1>YouTube Channel Subscriber Counts</h1>
  <ol id="subscriberCounts"></ol> <!-- リスト表示のための <ol> 要素 -->


  <script>
    // ここにJavaScriptコードを挿入
    // APIキー
    const API_KEY = 'AIzaSyDMInz0zVI_FuweiSmU92i2YeiIc_u7GzY';

// チャンネルIDと名前のマッピングを格納するオブジェクト
const channelData = {};

// チャンネルごとの登録者数を格納するオブジェクト
const subscriberCounts = {};

// チャンネルIDと名前をファイルから読み込む関数
async function readChannelData() {
  try {
    // ファイルを読み込む
    const response = await fetch('channel_data.txt');
    const text = await response.text();
    
    // 行ごとに処理
    text.trim().split('\n').forEach(line => {
      const [channelId, channelName] = line.split(':');
      channelData[channelId.trim()] = channelName.trim(); // 余分なスペースを取り除く
    });
  } catch (error) {
    console.error('Error reading channel data:', error);
  }
}

// チャンネルごとの登録者数を取得し、オブジェクトに格納する関数
async function fetchSubscriberCounts() {
  try {
    for (let channelId in channelData) {
      const count = await getSubscriberCount(channelId);
      subscriberCounts[channelId] = count;
    }
  } catch (error) {
    console.error('Error fetching subscriber counts:', error);
  }
}

// ランキングを表示する関数
function displaySubscriberCounts() {
  const subscriberCountsElement = document.getElementById('subscriberCounts');
  // チャンネル登録者数でソート
  const sortedChannelIds = sortSubscriberCounts();
  // ソートされたチャンネルIDごとに表示
  sortedChannelIds.forEach(channelId => {
    const p = document.createElement('p');
    const channelName = channelData[channelId];
    p.textContent = `${channelName}: ${subscriberCounts[channelId]} subscribers`;
    subscriberCountsElement.appendChild(p);
  });
}

// チャンネル登録者数で降順にソートする関数
function sortSubscriberCounts() {
  // ソートしたチャンネルIDの配列を取得
  const sortedChannelIds = Object.keys(subscriberCounts).sort((a, b) => {
    return subscriberCounts[b] - subscriberCounts[a];
  });
  return sortedChannelIds;
}

// メイン処理
async function main() {
  await readChannelData(); // チャンネルIDと名前の読み込み
  await fetchSubscriberCounts(); // 登録者数の取得
  displaySubscriberCounts(); // ランキングの表示
}

// メイン処理の実行
main();
  </script>
</body>
</html>
